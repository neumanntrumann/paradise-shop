<!-- marketplace.html -->
<!DOCTYPE html>
<html lang="en">
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<title>Marketplace</title>
<style>body{font-family:'Segoe UI';margin:0;padding:2rem;background:#fff8dc}h2{text-align:center}ul{list-style:none;padding:0}li{padding:.5rem;margin:.5rem;background:#f0f0f0;border-radius:8px}</style></head>
<body>
<h2>Available Products</h2><ul id="productList"></ul>
<script>async function load(){const p=await fetch('/api/products',{credentials:'include'});const j=await p.json();const r=await fetch('/api/csrf-token');const{csrf_token}=await r.json();document.getElementById('productList').innerHTML = j.map(p=>`<li>${p.name} - $${p.price}<button onclick="addToCart(${p.id},'${csrf_token}')">Add</button></li>`).join('');}async function addToCart(id,token){await fetch('/api/cart',{method:'POST',headers:{'Content-Type':'application/json','X-CSRFToken':token},credentials:'include',body:JSON.stringify({product_id:id})});alert("Added to cart") }load();</script>
</body></html>
